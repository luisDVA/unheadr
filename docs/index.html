<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Handle Data with Messy Header Rows and Broken Values • unheadr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Handle Data with Messy Header Rows and Broken Values">
<meta property="og:description" content="Verb-like functions to work with messy data, often derived from 
             spreadsheets or parsed PDF tables. Includes functions for unwrapping 
             values broken up across rows, relocating embedded grouping values, 
             and to annotate meaningful formatting in spreadsheet files.">
<meta property="og:image" content="unheadr.liomys.mx/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">unheadr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/unheadr-vignette.html">Introduction to unheadr</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/luisDVA/unheadr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="unheadr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#unheadr" class="anchor"></a>unheadr <img src="reference/figures/logosmall.png" align="right">
</h1></div>
<!-- badges: start -->

<p>The goal of <code>unheadr</code> is to help wrangle data when it has embedded subheaders, or when values are wrapped across several rows. <a href="https://unheadr.liomys.mx/" class="uri">https://unheadr.liomys.mx/</a></p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the CRAN release or the development version with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># Install unheadr from CRAN:</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"unheadr"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># Or install the development version from GitHub with:</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"luisDVA/unheadr"</span>)</a></code></pre></div>
<p>Some of the possible uses of <code>unheadr</code> are now described in this publication:</p>
<p>Verde Arregoitia, L. D., Cooper, N., D’Elía, G. (2018). Good practices for sharing analysis-ready data in mammalogy and biodiversity research. <em>Hystrix, the Italian Journal of Mammalogy</em>, 29(2), 155-161. <a href="https://doi.org/10.4404/hystrix-00133-2018">Open Access, DOI 10.4404/hystrix-00133-2018</a></p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p><strong>untangle2() function</strong></p>
<p><code><a href="reference/untangle2.html">untangle2()</a></code> puts embedded subheaders into their own variable, using regular expressions to identify them.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(primates2017)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># head(primates2017,n=20)</span></a></code></pre></div>
<p>The first half of the dataset looks like the table below. Note that there are rows that correspond to values in grouping variables, which should be in their own column. Instead, they are embedded within the data rectangle. This is a pretty common practice. This looks OK and is easy to read, but hard to work with (for example: calculating group-wise summaries).</p>
<p>In this example, values for an implicit ‘geographic region’ variable and an implicit ‘taxonomic family’ variable are embedded in the column that contains the observational units (the scientific names of various primates).</p>
<table class="table">
<thead><tr class="header">
<th align="left">scientific_name</th>
<th align="left">common_name</th>
<th align="left">red_list_status</th>
<th align="right">mass_kg</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Asia</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">CERCOPITHECIDAE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Trachypithecus obscurus</td>
<td align="left">Dusky Langur</td>
<td align="left">NT</td>
<td align="right">7.13</td>
</tr>
<tr class="even">
<td align="left">Presbytis sumatra</td>
<td align="left">Black Sumatran Langur</td>
<td align="left">EN</td>
<td align="right">6.00</td>
</tr>
<tr class="odd">
<td align="left">Rhinopithecus roxellana</td>
<td align="left">Golden Snub-nosed Monkey</td>
<td align="left">EN</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus auratus</td>
<td align="left">East Javan Langur</td>
<td align="left">VU</td>
<td align="right">6.25</td>
</tr>
<tr class="odd">
<td align="left">Semnopithecus johnii</td>
<td align="left">Nilgiri Langur</td>
<td align="left">VU</td>
<td align="right">11.45</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus delacouri</td>
<td align="left">Delacour’s Langur</td>
<td align="left">CR</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Trachypithecus leucocephalus</td>
<td align="left">White-headed Langur</td>
<td align="left">CR</td>
<td align="right">8.00</td>
</tr>
<tr class="even">
<td align="left">Presbytis comata</td>
<td align="left">Javan Langur</td>
<td align="left">EN</td>
<td align="right">6.70</td>
</tr>
<tr class="odd">
<td align="left">Macaca pagensis</td>
<td align="left">Pagai Macaque</td>
<td align="left">CR</td>
<td align="right">4.50</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus germaini</td>
<td align="left">Germain’s Langur</td>
<td align="left">EN</td>
<td align="right">8.83</td>
</tr>
<tr class="odd">
<td align="left">Macaca munzala</td>
<td align="left">Arunachal Macaque</td>
<td align="left">EN</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Macaca mulatta</td>
<td align="left">Rhesus Macaque</td>
<td align="left">LC</td>
<td align="right">9.90</td>
</tr>
<tr class="odd">
<td align="left">Semnopithecus hector</td>
<td align="left">Terai Sacred Langur</td>
<td align="left">NT</td>
<td align="right">15.20</td>
</tr>
<tr class="even">
<td align="left">HYLOBATIDAE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Hylobates funereus</td>
<td align="left">East Bornean Gray Gibbon</td>
<td align="left">EN</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Hylobates klossii</td>
<td align="left">Kloss’s Gibbon</td>
<td align="left">EN</td>
<td align="right">5.80</td>
</tr>
<tr class="odd">
<td align="left">Nomascus concolor</td>
<td align="left">Western Black Crested Gibbon</td>
<td align="left">CR</td>
<td align="right">7.71</td>
</tr>
<tr class="even">
<td align="left">LORISIDAE</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>For a tidier structure, these subheaders embedded in the <em>scientific_name</em> column need to be plucked out and placed in their own variable. This is the main objective of <code>unheadr</code> and what <code><a href="reference/untangle2.html">untangle2()</a></code> was made for.</p>
<p>If these subheaders can be matched in bulk with a regular expression because they share a prefix, suffix, or anything in common, we can save a lot of time. Otherwise, they can be matched by name.</p>
<p>Sorting out the mess in the example data:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># put taxonomic family in its own variable (matches the suffix "DAE")</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="reference/untangle2.html">untangle2</a></span>(primates2017, <span class="st">"DAE$"</span>, scientific_name, family)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># put geographic regions in their own variable (matching them all by name)</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="reference/untangle2.html">untangle2</a></span>(primates2017, <span class="st">"Asia|Madagascar|Mainland Africa|Neotropics"</span>, scientific_name, region)</a></code></pre></div>
<p>The function can be used with <code>magrittr</code> pipes as a dplyr-type verb.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">primates2017 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="reference/untangle2.html">untangle2</a></span>(<span class="st">"DAE$"</span>, scientific_name, family) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="reference/untangle2.html">untangle2</a></span>(<span class="st">"Asia|Madagascar|Mainland Africa|Neotropics"</span>, scientific_name, region) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="dt">n =</span> <span class="dv">20</span>)</a></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">scientific_name</th>
<th align="left">common_name</th>
<th align="left">red_list_status</th>
<th align="right">mass_kg</th>
<th align="left">family</th>
<th align="left">region</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Trachypithecus obscurus</td>
<td align="left">Dusky Langur</td>
<td align="left">NT</td>
<td align="right">7.13</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Presbytis sumatra</td>
<td align="left">Black Sumatran Langur</td>
<td align="left">EN</td>
<td align="right">6.00</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Rhinopithecus roxellana</td>
<td align="left">Golden Snub-nosed Monkey</td>
<td align="left">EN</td>
<td align="right">NA</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus auratus</td>
<td align="left">East Javan Langur</td>
<td align="left">VU</td>
<td align="right">6.25</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Semnopithecus johnii</td>
<td align="left">Nilgiri Langur</td>
<td align="left">VU</td>
<td align="right">11.45</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus delacouri</td>
<td align="left">Delacour’s Langur</td>
<td align="left">CR</td>
<td align="right">NA</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Trachypithecus leucocephalus</td>
<td align="left">White-headed Langur</td>
<td align="left">CR</td>
<td align="right">8.00</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Presbytis comata</td>
<td align="left">Javan Langur</td>
<td align="left">EN</td>
<td align="right">6.70</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Macaca pagensis</td>
<td align="left">Pagai Macaque</td>
<td align="left">CR</td>
<td align="right">4.50</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Trachypithecus germaini</td>
<td align="left">Germain’s Langur</td>
<td align="left">EN</td>
<td align="right">8.83</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Macaca munzala</td>
<td align="left">Arunachal Macaque</td>
<td align="left">EN</td>
<td align="right">NA</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Macaca mulatta</td>
<td align="left">Rhesus Macaque</td>
<td align="left">LC</td>
<td align="right">9.90</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Semnopithecus hector</td>
<td align="left">Terai Sacred Langur</td>
<td align="left">NT</td>
<td align="right">15.20</td>
<td align="left">CERCOPITHECIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Hylobates funereus</td>
<td align="left">East Bornean Gray Gibbon</td>
<td align="left">EN</td>
<td align="right">NA</td>
<td align="left">HYLOBATIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Hylobates klossii</td>
<td align="left">Kloss’s Gibbon</td>
<td align="left">EN</td>
<td align="right">5.80</td>
<td align="left">HYLOBATIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Nomascus concolor</td>
<td align="left">Western Black Crested Gibbon</td>
<td align="left">CR</td>
<td align="right">7.71</td>
<td align="left">HYLOBATIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Nycticebus menagensis</td>
<td align="left">Philippine Slow Loris</td>
<td align="left">VU</td>
<td align="right">0.28</td>
<td align="left">LORISIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="even">
<td align="left">Nycticebus bengalensis</td>
<td align="left">Bengal Slow Loris</td>
<td align="left">VU</td>
<td align="right">1.21</td>
<td align="left">LORISIDAE</td>
<td align="left">Asia</td>
</tr>
<tr class="odd">
<td align="left">Allocebus trichotis</td>
<td align="left">Hairy-eared Dwarf Lemur</td>
<td align="left">VU</td>
<td align="right">0.09</td>
<td align="left">CHEIROGALEIDAE</td>
<td align="left">Madagascar</td>
</tr>
<tr class="even">
<td align="left">Microcebus tavaratra</td>
<td align="left">Tavaratra Mouse Lemur</td>
<td align="left">VU</td>
<td align="right">0.06</td>
<td align="left">CHEIROGALEIDAE</td>
<td align="left">Madagascar</td>
</tr>
</tbody>
</table>
<p>Now we can easily perform grouping operations and summarize the data (e.g. calculating average body mass by Family).</p>
<p>At this point, refer to the links in the vignette and the function help for more information and examples on the use of the other helper functions.</p>
<p><strong>unbreak_vals() function</strong></p>
<p>This is a niche function for very specific uses. It uses regex to fix values that are broken across two rows. This usually happens when we are formatting a table and we need to fit it on a page.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">dogsDesc &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="dt">dogs =</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">    <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Retriever"</span>, <span class="st">"(Golden)"</span>, <span class="st">"Retriever"</span>, <span class="st">"(Labrador)"</span>, <span class="st">"Bulldog"</span>, <span class="st">"(French)"</span>),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  <span class="dt">coat =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"long"</span>, <span class="ot">NA</span>, <span class="st">"short"</span>, <span class="ot">NA</span>, <span class="st">"short"</span>, <span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(dogsDesc)</a></code></pre></div>
<p>We can match the opening brackets with regex.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="reference/unbreak_vals.html">unbreak_vals</a></span>(dogsDesc,<span class="st">"^</span><span class="ch">\\</span><span class="st">("</span>,dogs, dogs_unbroken)</a></code></pre></div>
<p><strong>unwrap_cols() function</strong></p>
<p>Use this function to unwrap and glue values that have been wrapped across multiple rows for presentation purposes, with an inconsistent number of empty or <code>NA</code> values padding out the columns.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># set up the data</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">nyk &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span>(</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  <span class="op">~</span>player, <span class="op">~</span>listed_height_m., <span class="op">~</span>teams_chronological, <span class="op">~</span>position,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  <span class="st">"Marcus Camby"</span>, <span class="fl">2.11</span>, <span class="st">"Raptors"</span>, <span class="st">"Power forward"</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Knicks"</span>, <span class="st">"Center"</span>,</a>
<a class="sourceLine" id="cb7-6" data-line-number="6">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Nuggets"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Clippers"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-8" data-line-number="8">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Trail Blazers"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Rockets"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Knicks"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">  <span class="st">"Allan Houston"</span>, <span class="fl">1.98</span>, <span class="st">"Pistons"</span>, <span class="st">"Shooting guard"</span>,</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Knicks"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">  <span class="st">"Latrell Sprewell"</span>, <span class="fl">1.96</span>, <span class="st">"Warriors"</span>, <span class="st">"Small forward"</span>,</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Knicks"</span>, <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">  <span class="ot">NA</span>, <span class="ot">NA</span>, <span class="st">"Timberwolves"</span>, <span class="ot">NA</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">)</a></code></pre></div>
<p>Paste the wrapped elements, separating with commas.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="reference/unwrap_cols.html">unwrap_cols</a></span>(nyk, <span class="dt">groupingVar =</span> player, <span class="dt">separator =</span> <span class="st">", "</span>)</a></code></pre></div>
<p><strong>unbreak_rows() function</strong></p>
<p>This function merges sets of two contiguous rows ‘upwards’ by pasting the values of the lagging row to the values of the leading row (identified using regular expressions).</p>
<p>The following table of basketball records has two sets of header rows with values broken across two contiguous rows.</p>
<table class="table">
<thead><tr class="header">
<th align="left">v1</th>
<th align="left">v2</th>
<th align="left">v3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Player</td>
<td align="left">Most points</td>
<td align="left">Season</td>
</tr>
<tr class="even">
<td align="left">NA</td>
<td align="left">in a game</td>
<td align="left">(year ending)</td>
</tr>
<tr class="odd">
<td align="left">Sleve McDichael</td>
<td align="left">55</td>
<td align="left">2001</td>
</tr>
<tr class="even">
<td align="left">Dean Wesrey</td>
<td align="left">43</td>
<td align="left">2000</td>
</tr>
<tr class="odd">
<td align="left">Karl Dandleton</td>
<td align="left">41</td>
<td align="left">2010</td>
</tr>
<tr class="even">
<td align="left">Player</td>
<td align="left">Most varsity</td>
<td align="left">Season</td>
</tr>
<tr class="odd">
<td align="left">NA</td>
<td align="left">games played</td>
<td align="left">(year ending)</td>
</tr>
<tr class="even">
<td align="left">Mike Sernandez</td>
<td align="left">111</td>
<td align="left">2005</td>
</tr>
<tr class="odd">
<td align="left">Glenallen Mixon</td>
<td align="left">109</td>
<td align="left">2004</td>
</tr>
<tr class="even">
<td align="left">Rey McSriff</td>
<td align="left">104</td>
<td align="left">2002</td>
</tr>
</tbody>
</table>
<p><code><a href="reference/unbreak_rows.html">unbreak_rows()</a></code> merges these rows if we can match them with a common pattern.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">bball &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  <span class="dt">v1 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb9-4" data-line-number="4">    <span class="st">"Player"</span>, <span class="ot">NA</span>, <span class="st">"Sleve McDichael"</span>, <span class="st">"Dean Wesrey"</span>,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="st">"Karl Dandleton"</span>, <span class="st">"Player"</span>,</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="ot">NA</span>,</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="st">"Mike Sernandez"</span>,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="st">"Glenallen Mixon"</span>,</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    <span class="st">"Rey McSriff"</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  ),</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">  <span class="dt">v2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">    <span class="st">"Most points"</span>, <span class="st">"in a game"</span>, <span class="st">"55"</span>, <span class="st">"43"</span>, <span class="st">"41"</span>, <span class="st">"Most varsity"</span>,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">    <span class="st">"games played"</span>, <span class="st">"111"</span>, <span class="st">"109"</span>,</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">    <span class="st">"104"</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">  ),</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">  <span class="dt">v3 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">    <span class="st">"Season"</span>, <span class="st">"(year ending)"</span>, <span class="st">"2001"</span>, <span class="st">"2000"</span>, <span class="st">"2010"</span>, <span class="st">"Season"</span>,</a>
<a class="sourceLine" id="cb9-18" data-line-number="18">    <span class="st">"(year ending)"</span>, <span class="st">"2005"</span>,</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">    <span class="st">"2004"</span>, <span class="st">"2002"</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20">  )</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22"></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co"># Match with regex on variable v2</span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="kw"><a href="reference/unbreak_rows.html">unbreak_rows</a></span>(bb3,<span class="st">"^Most"</span>,v2)</a></code></pre></div>
<p>The resulting table:</p>
<table class="table">
<thead><tr class="header">
<th align="left">v1</th>
<th align="left">v2</th>
<th align="left">v3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Player</td>
<td align="left">Most points in a game</td>
<td align="left">Season (year ending)</td>
</tr>
<tr class="even">
<td align="left">Sleve McDichael</td>
<td align="left">55</td>
<td align="left">2001</td>
</tr>
<tr class="odd">
<td align="left">Dean Wesrey</td>
<td align="left">43</td>
<td align="left">2000</td>
</tr>
<tr class="even">
<td align="left">Karl Dandleton</td>
<td align="left">41</td>
<td align="left">2010</td>
</tr>
<tr class="odd">
<td align="left">Player</td>
<td align="left">Most varsity games played</td>
<td align="left">Season (year ending)</td>
</tr>
<tr class="even">
<td align="left">Mike Sernandez</td>
<td align="left">111</td>
<td align="left">2005</td>
</tr>
<tr class="odd">
<td align="left">Glenallen Mixon</td>
<td align="left">109</td>
<td align="left">2004</td>
</tr>
<tr class="even">
<td align="left">Rey McSriff</td>
<td align="left">104</td>
<td align="left">2002</td>
</tr>
</tbody>
</table>
<p><strong>annotate_mf() function</strong></p>
<p>Sometimes embedded subheaders can’t be matched by content or context, but they share the same formatting in a spreadsheet file.</p>
<p>The <code><a href="reference/annotate_mf.html">annotate_mf()</a></code> function flattens four common approaches to confer meaningful formatting to cells and adds this as a character string to the target variable.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">example_spreadsheet &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/dog_test.xlsx"</span>, <span class="dt">package =</span> <span class="st">"unheadr"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="reference/annotate_mf.html">annotate_mf</a></span>(example_spreadsheet,<span class="dt">orig =</span> Task, <span class="dt">new=</span>Task_annotated)</a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=unheadr">https://​cloud.r-project.org/​package=unheadr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/luisDVA/unheadr">https://​github.com/​luisDVA/​unheadr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/luisDVA/unheadr/issues">https://​github.com/​luisDVA/​unheadr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing unheadr</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Luis D. Verde Arregoitia <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-9520-6543" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Luis D. Verde Arregoitia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
